AI新手网，https://aixinshou.com/  全站9.9元终身免费下载！

本章我们将使用 Cursor AI 开发一个微信小程序。这个小程序可以通过 Coze 平台的 API 生成图片。整个开发过程包括基础架构搭建、页面组件开发、云函数配置和核心功能实现。通过这个实例，你将学习如何使用 AI 工具高效开发微信小程序，并解决开发中遇到的各种问题。

基础结构搭建
------

打开 Cursor Chat 窗口，创建一个新会话，输入提示词：

```swift
根据 @需求分析文档.md @技术方案.md 文档，进行基础架构搭建，并为小程序项目添加所需的文件

注意，云函数已经配置过了，不需要在配置了
```

![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d734462e038e449eb11dadb1ebee6f56~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.jpg#?w=1218&h=667&s=209957&e=png&b=1d1d1c)

完成后，打开微信开发者工具，查看最新效果。

页面成功运行起来了，发现 AI 是真的不偷懒，我只是让它完成基础架构搭建，它把页面功能都给我实现了。

不过，我们还是要参照 UI 设计稿，对页面进行调整。

![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/290a4f89efe44253b491664d708a31d3~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.jpg#?w=1276&h=953&s=228458&e=png&b=282828) 微信开发者工具中，我们主要关注的是左侧的模拟器效果和右侧调试器 Console 日志输出。有一些云函数调用失败的日志，我们后面再解决。

如果你有多个屏幕了，一个屏幕展示微信开发者工具，一个屏幕展示 Cursor 编辑器，这样最好。

如果只有一个屏幕了，可以调整两个工具的窗口大小，尽可能的在一个屏幕上展示。

这样 Cursor 编辑器一边写代码，一边在微信开发者工具看模拟器效果，非常方便。

![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2eb62f983f9e49b891867eff9b960027~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.jpg#?w=2555&h=1028&s=673764&e=png&b=1d1d1d)

页面组件开发
------

打开 Cursor Chat 窗口中，创建一个新会话，输入提示词：

```swift
根据 @需求分析文档.md @技术方案.md 文档和 UI 设计稿中的样式，开发页面组件

注意，请严格按照 UI 图中的样式进行开发。
```

![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/69c45256674e44baa3af6d5a8330c8ce~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.jpg#?w=800&h=218&s=36726&e=png&b=181818)

初次的效果不是很理想，只是色调和 UI 设计稿中的色调差不多一致，但是样式和布局还是有很大差别。

接下来又优化了两次

![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6031a81754df4cf0a1e38cf64c8b919f~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.jpg#?w=794&h=201&s=30835&e=png&b=191919)

![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c586577f9aaf412081c6842a4b9a441a~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.jpg#?w=794&h=193&s=27274&e=png&b=191919)

以下为最终的效果，相对比较接近 UI 设计稿了（100% 还原还是有点难度！）。

目前这里还只是生成图片之前的样式交互，生成图片之后的样式交互，我们先把云函数调用成功，再看看效果进行优化。

![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7ce43810425647c6a9ee6f19817fdbb2~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.jpg#?w=390&h=571&s=39825&e=png&b=fafafa)

云函数配置环境变量
---------

在微信开发者工具中，打开云开发控制台，点击云函数，进入云函数列表。

点击 “版本与配置” 按钮，进入云函数配置页。

![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/239b70e480a94e5b9732903d8b12bb9f~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.jpg#?w=1238&h=60&s=11983&e=png&b=2e2e2e)

点击 “配置” 按钮，在打开的 “配置云函数” 窗口中，点开 “高级配置” 按钮，在环境变量中，添加 `TOKEN`、`WORKFLOW_ID` 变量，值从 “搭建 Coze 环境” 章节中获取，当时有讲解怎么获取。

随后点击 “确认” 按钮，保存配置。

![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bb984a46754242018386b17d90fcc7b0~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.jpg#?w=1277&h=662&s=100502&e=png&b=2b2b2b)

核心功能和云函数开发
----------

打开 Cursor Chat 窗口中，创建一个新会话，输入提示词：

```swift
根据 @需求分析文档.md @技术方案.md 参考实现步骤的第 “4. 云函数开发”、“5. 核心功能实现” 开发

我已在云函数通过环境变量配置了 Coze 的 TOKEN、WORKFLOW_ID，请你在代码实现中通过环境变量来取这两个值，参考第一张图，是关于云函数配置环境变量的。

第二张图是 Coze 的 API 调用示例，请你参考这个示例完成云函数到 Coze API 的调用

注意，当前的 UI 已经优化过了，不需要重新修改，现在你的责任是主要负责 UI 对应的业务逻辑开发
```

![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/99e129ec2d3c440a917fc3d87665537e~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.jpg#?w=765&h=317&s=69751&e=png&b=191919)

提示词中的两张图片，需要你提供

第一张图片是云函数配置环境变量的截图

![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/abe6eced5163499fa9b531f4d63a9ca1~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.jpg#?w=503&h=664&s=49226&e=png&b=2f2f2f)

第二张图片是 Coze 的 API 调用示例，在 Coze 平台获取，当时有讲解怎么获取，这个很重要，如果把这个提供给 Cursor，它生成的 Coze API 调用代码会很准确。

![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/546dd522a42c475aa89e8f08fc12f866~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.jpg#?w=1372&h=1215&s=313084&e=png&b=ffffff)

在微信开发者工具模拟器中进行测试，页面提示生成图片失败，但控制台也没有错误日志输出。

![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4feb21cd621b495d9d1ac38d074c8c4f~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.jpg#?w=1180&h=787&s=121402&e=png&b=242424)

接下来我们让 Cursor 帮忙排查问题，必要时加一个日志输出，输入提示词：

```
页面提示生成图片失败，但控制台也没有错误日志输出，请你检查原因，如果必要请打印关键输出日志，协助排查问题
```

![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/99de2735f2da424794da256bc216c4be~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.jpg#?w=750&h=153&s=20904&e=png&b=191919)

注意，如果云函数有修改，需要重新部署云函数，否则不会生效。在云函数上右击，选择 “上传并部署（不上传 node\_modules）” 按钮，上传云函数。

![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3435a2184b874e84a0819560068fccd0~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.jpg#?w=511&h=173&s=39298&e=png&b=2b2b2b)

接下来测试我们还需要打开云函数的日志输出，点击 “云函数” 按钮，点击 “日志” 按钮，记得选择你要调试的云函数，即可查看每次调用的日志输出。

![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/acf52fb18842443e8b9980736b515387~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.jpg#?w=900&h=161&s=30898&e=png&b=3a3a3a)

让我们再次进行测试，这一次看到错误输出了，这个错误你丢给 Cursor ，它也解决不了，云函数的默认超时时间太短了，需要在界面上修改云函数的超时时间。

![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5362bf5981a844b882f744018108f36f~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.jpg#?w=1285&h=1054&s=383729&e=png&b=2d2d2d)

另外控制台输出日志，有句 “`请前往云开发AI小助手查看问题：https://tcb.cloud.tencent.com/dev#/helper/copilot?q=FUNCTIONS_TIME_LIMIT_EXCEEDED` ” 打开这个链接，我原因以为腾讯云的 AI 助手能准确告诉我答案，结果就一直在浪费时间，给了几个方案都解决不了。

![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1a889c131999422b91dd4a7db1642704~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.jpg#?w=1883&h=1375&s=342748&e=png&b=eff0f3)

打开云函数的配置窗口，修改超时时间，修改之前为 3 秒，修改之后为 20 秒。

![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6de21b26855d4f448d25540a3ff05dca~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.jpg#?w=1165&h=519&s=75174&e=png&b=2f2f2f)

修改之后，再次测试，还有错误输出，但这次能看到云函数调用 Coze API 是成功的，并且返回的图片地址在浏览器打开是正常的。

![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/779daef416064ffc8498217e3a294454~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.jpg#?w=1234&h=594&s=213967&e=png&b=272727)

也要记得查看云函数的日志输出，发现云函数调用 Coze API 是成功的，但是返回数据格式云函数没有正确解析，导致页面报错。

![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4bd3c17733524549967d9c0c1f89f1cf~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.jpg#?w=899&h=618&s=155175&e=png&b=333333)

我们把这两个图片丢给 Cursor ，让它帮忙解决，输入提示词：

```
现在云函数调用 Coze API 是成功的，并且返回的 URL 在浏览器也能正常打开，请仔细阅读图中的错误信息，查找问题原因并进行修复
```

![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0404491738764739930e16077ee5cb15~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.jpg#?w=763&h=137&s=22925&e=png&b=191919)

再次进行测试，这一次页面提示生成图片成功了。

![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/40ee4320e9e643cfa85b7213f9a547a8~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.jpg#?w=380&h=739&s=212822&e=png&b=f9f8f8)

页面样式优化
------

### 底部按钮样式优化

从上图能看到保存底部 “保存到相册”、“重新生成” 按钮的样式有点不好看，我们让 Cursor 帮忙优化下，输入提示词：

```
底部两个按钮内部文本没有垂直对齐，两个按钮之间没有间距，请适当增加一些间距
```

![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a7c75ad484a84a79955aad3991aba5ab~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.jpg#?w=753&h=167&s=22267&e=png&b=181818)

以下为优化后的效果

![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9740860e2f1743528c1589e47e870016~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.jpg#?w=372&h=463&s=171695&e=png&b=fbf9f9)

### 推荐提示词增加一个收起按钮

如果你觉得哪里看起来不太舒服了，可以随时让 Cursor 帮忙优化，例如我觉得推荐提示词有点占用地方，让 Cursor 帮忙增加一个收起按钮，输入提示词：

```
推荐提示词加一个折叠按钮
```

![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a754a8d412224adcb79d318c131ed518~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.jpg#?w=1901&h=891&s=291044&e=png&b=181818)

测试下三个页面类型的生成效果
--------------

让我们测试下三个页面类型的生成效果，看是否正常，输入提示词：

```
小女孩手里抱着小猫咪
```

“人像” 类型生成效果。

![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/30709e0db3d047d4ad1a8fa9dfcff34c~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.jpg#?w=382&h=796&s=190317&e=png&b=f0e6e5)

“动漫” 类型生成效果。

![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d8971faa9386496a867cd662bfb6a48e~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.jpg#?w=393&h=796&s=228302&e=png&b=f7f1f0)

“通用” 类型生成效果。

![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/75761600cdf64a2fa9460122f54f3a94~tplv-k3u1fbpfcp-jj-mark:1600:0:0:0:q75.jpg#?w=386&h=797&s=204164&e=png&b=f7f2f1)

测试下来都没有什么问题，大家觉得哪个效果更好呢？

总结
--

通过本章的实践，我们完成了一个微信小程序的开发。这个小程序可以根据用户输入的提示词生成不同风格的图片。整个开发过程中，我们使用了 Cursor AI 辅助完成了基础结构搭建、页面组件开发、云函数配置以及核心功能实现。

在开发过程中，我们遇到了一些问题，比如云函数超时、数据格式解析错误等，通过调试和 Cursor AI 的帮助，我们一一解决了这些问题。最后，我们还对页面进行了样式优化，添加了更好的按钮样式和提示词折叠功能，使整个应用更加美观和实用。